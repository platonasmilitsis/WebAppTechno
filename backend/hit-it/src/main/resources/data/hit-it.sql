-- MySQL Script generated by MySQL Workbench
-- Κυρ 17 Ιουλ 2022 06:00:38 μμ EEST
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`users` ;

CREATE TABLE IF NOT EXISTS `mydb`.`users` (
  `id` INT NOT NULL auto_increment,
  `username` VARCHAR(45) NOT NULL,
  `password` VARCHAR(45) NOT NULL,
  `first_name` VARCHAR(45) NOT NULL,
  `last_name` VARCHAR(45) NOT NULL,
  `telephone` VARCHAR(45) NULL,
  `email` VARCHAR(45) NOT NULL,
  `address` VARCHAR(45) NULL,
  `tin` VARCHAR(10) NOT NULL,
  `admin` TINYINT NULL,
  `accepted` TINYINT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


INSERT INTO users
values
    (1,'admin','1234','Themistoklis','Rambossa','2106991232','themakos@gmail.com','Tositsas 18','010101',1,1),
    (2,'Lst','1234','Lefteris','Stetsikas','2106007393','lst3@gmail.com','Theodosiou 18','0010101',0,1),
    (3,'Dberos97','1234','Dimitrios','Beros','2106262613','dberos97@gmail.com','Nea Smirni 18','000045',0,1),
    (4,'Ourt','1234','Platonas','Militsis','2441068681','platonasOMilitsios@gmail.com','Valvi 27','431000',0,1),
    (5,'PlasPlas','1234','Konstantinos','Plas','2105555555','kost++@gmail.com','Loutsa 27','431120',0,1),
    (6,'Felarxos','1234','Haris','Korovesis','231000000','fel@gmail.com','Fellas 27','44442',0,1);




-- -----------------------------------------------------
-- Table `mydb`.`item`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`item` ;

CREATE TABLE IF NOT EXISTS `mydb`.`item` (
  `id` INT NOT NULL auto_increment,
  `name` VARCHAR(45) NOT NULL,
  `first_bid` INT NULL,
  `buy_price` INT NOT NULL,
  `location` VARCHAR(45) NOT NULL,
  `country` VARCHAR(45) NOT NULL,
  `latitude` VARCHAR(45),
  `longitude` VARCHAR(45),
  `users_id` INT NOT NULL,
  `img_path` VARCHAR(45),
  `description` TEXT,
  PRIMARY KEY (`id`),
  INDEX `fk_item_users1_idx` (`users_id` ASC) VISIBLE,
  CONSTRAINT `fk_item_users1`
    FOREIGN KEY (`users_id`)
    REFERENCES `mydb`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO item
values
    (1,'Item 1',400,4000,'Athens','Greece',null,null,'2',null,"Description 1"),
    (2,'Item 2',400,4000,'Athens','Greece',null,null,'2',null,"Description 2"),
    (3,'Item 3',400,4000,'Athens','Greece',null,null,'2',null,"Description 3"),
    (4,'Item 4',400,4000,'Athens','Greece',null,null,'2',null,"Description 4"),
    (5,'Item 5',400,4000,'Athens','Greece',null,null,'3',null,"Description 5"),
    (6,'Item 6',400,4000,'Athens','Greece',null,null,'4',null,"Description 6");


-- -----------------------------------------------------
-- Table `mydb`.`category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`category` ;

CREATE TABLE IF NOT EXISTS `mydb`.`category` (
  `id` INT NOT NULL auto_increment,
  `category` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;

Insert Into category
values
    (1,'Texnologia'),
    (2,'Kommounismos'),
    (3,'Spiti'),
    (4,'Kipos'),
    (5,'Fagito'),
    (6,'Pota'),
    (7,'Patsa');


-- -----------------------------------------------------
-- Table `mydb`.`item_category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`item_category` ;

CREATE TABLE IF NOT EXISTS `mydb`.`item_category` (
  `category_id` INT NOT NULL,
  `item_id` INT NOT NULL,
  PRIMARY KEY (`category_id`, `item_id`),
  INDEX `fk_item_category_item1_idx` (`item_id` ASC) VISIBLE,
  CONSTRAINT `fk_item_category_category1`
    FOREIGN KEY (`category_id`)
    REFERENCES `mydb`.`category` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_item_category_item1`
    FOREIGN KEY (`item_id`)
    REFERENCES `mydb`.`item` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO item_category
values
    (1,1),(1,2),(1,3),(1,4),
    (2,1),(2,4),(2,5),(2,6),
    (3,1),
    (5,1),(5,6),
    (6,1),(6,2),
    (7,6);


-- -----------------------------------------------------
-- Table `mydb`.`bids`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`bids` ;

CREATE TABLE IF NOT EXISTS `mydb`.`bids` (
  `id` INT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_bids_item1`
    FOREIGN KEY (`id`)
    REFERENCES `mydb`.`item` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;



INSERT INTO bids
values (1),(2),(3),(4),(5),(6);

-- -----------------------------------------------------
-- Table `mydb`.`bidder`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`bidder` ;

CREATE TABLE IF NOT EXISTS `mydb`.`bidder` (
  `id` INT NOT NULL,
  `location` VARCHAR(45) NOT NULL,
  `country` VARCHAR(45) NOT NULL,
  `rating` float NULL,
  INDEX `fk_bidder_users_idx` (`id` ASC) VISIBLE,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_bidder_users`
    FOREIGN KEY (`id`)
    REFERENCES `mydb`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO bidder
values
    (1,'Cholargos','Greece',3),
    (2,'Chalandri','Greece',null),
    (3,'Nea Smirni','Greece',null),
    (4,'Karditsa','Karditsa',null),
    (5,'Loutsa','Karditsa',null),
    (6,'Agia Fel Paraskevi','Greece',null);

-- -----------------------------------------------------
-- Table `mydb`.`bid`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`bid` ;

CREATE TABLE IF NOT EXISTS `mydb`.`bid` (
  `id` INT NOT NULL auto_increment,
  `time` timestamp NOT NULL,
  `amount` INT NOT NULL,
  `bids_id` INT NOT NULL,
  `bidder_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_bid_bids1_idx` (`bids_id` ASC) VISIBLE,
  CONSTRAINT `fk_bid_bids1`
    FOREIGN KEY (`bids_id`)
    REFERENCES `mydb`.`bids` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  INDEX `fk_bid_bidder1_idx` (`bidder_id` ASC) VISIBLE,
  CONSTRAINT `fk_bid_bidder1`
    FOREIGN KEY (`bidder_id`)
    REFERENCES `mydb`.`bidder` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


DROP TABLE IF EXISTS `mydb`.`reviews` ;

CREATE TABLE IF NOT EXISTS `mydb`.`reviews`
(
    `user_id`   int not null,
    `bidder_id` int not null,
    `review`    text,
    `rating`    float not null,
    INDEX `fk_reviews_users_bidders_idx` (`user_id` ASC, `bidder_id` ASC) VISIBLE,
    PRIMARY KEY (`user_id`, `bidder_id`),
    CONSTRAINT `fk_reviews_users`
        FOREIGN KEY (`user_id`)
            REFERENCES `mydb`.`users` (`id`)
            ON DELETE CASCADE
            ON UPDATE NO ACTION,
    CONSTRAINT `fk_reviews_bidders`
        FOREIGN KEY (`bidder_id`)
            REFERENCES `mydb`.`bidder` (`id`)
            ON DELETE CASCADE
            ON UPDATE NO ACTION
)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

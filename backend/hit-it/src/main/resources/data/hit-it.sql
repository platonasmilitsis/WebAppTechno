-- MySQL Script generated by MySQL Workbench
-- Κυρ 17 Ιουλ 2022 06:00:38 μμ EEST
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`users` ;

CREATE TABLE IF NOT EXISTS `mydb`.`users` (
  `id` INT NOT NULL auto_increment,
  `username` VARCHAR(45) NOT NULL,
  `password` TINYTEXT NOT NULL,
  `first_name` VARCHAR(45) NOT NULL,
  `last_name` VARCHAR(45) NOT NULL,
  `telephone` VARCHAR(45) NULL,
  `email` VARCHAR(45) NOT NULL,
  `address` VARCHAR(45) NULL,
  `tin` VARCHAR(10) NOT NULL,
  `admin` TINYINT NOT NULL,
  `accepted` TINYINT NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


INSERT INTO users
values
    (1,'admin','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Themistoklis','Rambossa','2106991232','themakos@gmail.com','Tositsas 18','010101',1,1),
    (2,'Lst','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Lefteris','Stetsikas','2106007393','lst3@gmail.com','Theodosiou 18','0010101',0,1),
    (3,'Dberos97','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Dimitrios','Beros','2106262613','dberos97@gmail.com','Nea Smirni 18','000045',0,1),
    (4,'Ourt','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Platonas','Militsis','2441068681','platonasOMilitsios@gmail.com','Valvi 27','431000',0,1),
    (5,'PlasPlas','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Konstantinos','Plas','2105555555','kost++@gmail.com','Loutsa 27','431120',0,1),
    (6,'Felarxos','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Haris','Korovesis','231000000','fel@gmail.com','Fellas 27','44442',0,1),
    (7,'User 7','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Userios','User','231200000','feld@gmail.com','Kolokotronis 27','443',0,0),
    (8,'User 8','$2a$10$vxTQrYwJmne7y8uonQgrKOQQayK67OEQkn/M9xzc6cALR7votIXQO','Useria','Useriou','231300000','feldc@gmail.com','Mpoumpoulinas 27','442',0,0);




-- -----------------------------------------------------
-- Table `mydb`.`item`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`item` ;

CREATE TABLE IF NOT EXISTS `mydb`.`item` (
  `id` INT NOT NULL auto_increment,
  `name` VARCHAR(45) NOT NULL,
  `first_bid` INT NULL,
  `buy_price` INT NOT NULL,
  `location` VARCHAR(45) NOT NULL,
  `country` VARCHAR(45) NOT NULL,
  `latitude` VARCHAR(45),
  `longitude` VARCHAR(45),
  `users_id` INT NOT NULL,
  `img_path` VARCHAR(45),
  `description` TEXT,
  PRIMARY KEY (`id`),
  INDEX `fk_item_users1_idx` (`users_id` ASC) VISIBLE,
  CONSTRAINT `fk_item_users1`
    FOREIGN KEY (`users_id`)
    REFERENCES `mydb`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO item
values
    (1,'Item 1',400,4000,'Athens','Greece',null,null,'2',null,'Description 1'),
    (2,'Item 2',400,4000,'Athens','Greece',null,null,'2',null,'Description 2'),
    (3,'Item 3',400,4000,'Athens','Greece',null,null,'2',null,'Description 3'),
    (4,'Item 4',400,4000,'Athens','Greece',null,null,'2',null,'Description 4'),
    (5,'Item 5',400,4000,'Athens','Greece',null,null,'3',null,'Description 5'),
    (6,'Item 6',400,4000,'Athens','Greece',null,null,'4',null,'Description 6');


-- -----------------------------------------------------
-- Table `mydb`.`category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`category` ;

CREATE TABLE IF NOT EXISTS `mydb`.`category` (
  `id` INT NOT NULL auto_increment,
  `category` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;

Insert Into category
values
    (1,'Texnologia'),
    (2,'Ypologistes'),
    (3,'Spiti'),
    (4,'Kipos'),
    (5,'Fagito'),
    (6,'Pota'),
    (7,'Patsa');


-- -----------------------------------------------------
-- Table `mydb`.`item_category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`item_category` ;

CREATE TABLE IF NOT EXISTS `mydb`.`item_category` (
  `category_id` INT NOT NULL,
  `item_id` INT NOT NULL,
  PRIMARY KEY (`category_id`, `item_id`),
  INDEX `fk_item_category_item1_idx` (`item_id` ASC) VISIBLE,
  CONSTRAINT `fk_item_category_category1`
    FOREIGN KEY (`category_id`)
    REFERENCES `mydb`.`category` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_item_category_item1`
    FOREIGN KEY (`item_id`)
    REFERENCES `mydb`.`item` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO item_category
values
    (1,1),(1,2),(1,3),(1,4),
    (2,1),(2,4),(2,5),(2,6),
    (3,1),
    (5,1),(5,6),
    (6,1),(6,2),
    (7,6);


-- -----------------------------------------------------
-- Table `mydb`.`bids`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`bids` ;

CREATE TABLE IF NOT EXISTS `mydb`.`bids` (
  `id` INT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_bids_item1`
    FOREIGN KEY (`id`)
    REFERENCES `mydb`.`item` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;



INSERT INTO bids
values (1),(2),(3),(4),(5),(6);

-- -----------------------------------------------------
-- Table `mydb`.`bidder`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`bidder` ;

CREATE TABLE IF NOT EXISTS `mydb`.`bidder` (
  `id` INT NOT NULL,
  `location` VARCHAR(45) NOT NULL,
  `country` VARCHAR(45) NOT NULL,
  `rating` float NULL,
  INDEX `fk_bidder_users_idx` (`id` ASC) VISIBLE,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_bidder_users`
    FOREIGN KEY (`id`)
    REFERENCES `mydb`.`users` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

INSERT INTO bidder
values
    (1,'Cholargos','Greece',200),
    (2,'Chalandri','Greece',220),
    (3,'Nea Smirni','Greece',180),
    (4,'Karditsa','Greece',100),
    (5,'Loutsa','Greece',1000),
    (6,'Agia Paraskevi','Greece',250);

-- -----------------------------------------------------
-- Table `mydb`.`bid`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`bid` ;

CREATE TABLE IF NOT EXISTS `mydb`.`bid` (
  `id` INT NOT NULL auto_increment,
  `time` timestamp NOT NULL,
  `amount` INT NOT NULL,
  `bids_id` INT NOT NULL,
  `bidder_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_bid_bids1_idx` (`bids_id` ASC) VISIBLE,
  CONSTRAINT `fk_bid_bids1`
    FOREIGN KEY (`bids_id`)
    REFERENCES `mydb`.`bids` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  INDEX `fk_bid_bidder1_idx` (`bidder_id` ASC) VISIBLE,
  CONSTRAINT `fk_bid_bidder1`
    FOREIGN KEY (`bidder_id`)
    REFERENCES `mydb`.`bidder` (`id`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


INSERT INTO bid
values
    (1,'2022-8-23 19:35',401,1,2),
    (2,'2022-8-23 19:40',420,1,3),
    (3,'2022-8-23 19:45',425,1,4),
    (4,'2022-8-23 19:50',450,1,5),
    (5,'2022-8-23 19:55',500,1,6),
    (6,'2022-8-23 20:00',700,1,7),
    (7,'2022-8-23 20:20',900,1,8),
    (8,'2022-8-23 19:40',401,2,2),
    (9,'2022-8-23 19:45',420,2,3),
    (10,'2022-8-23 19:50',425,2,4),
    (11,'2022-8-23 19:40',425,3,4),
    (12,'2022-8-23 19:40',425,4,4),
    (13,'2022-8-23 19:40',425,5,4);


-- -----------------------------------------------------
-- Table `mydb`.`messages`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`messages` ;

CREATE TABLE IF NOT EXISTS `mydb`.`messages` (
    `id` INT NOT NULL auto_increment,
    `seller_id` INT NOT NULL,
    `buyer_id` INT NOT NULL,
    PRIMARY KEY (`id`),
    INDEX `fk_messages_seller_idx` (`seller_id` ASC) VISIBLE,
    CONSTRAINT `fk_messages_seller1`
        FOREIGN KEY (`seller_id`)
            REFERENCES `mydb`.`users` (`id`)
            ON DELETE CASCADE
            ON UPDATE NO ACTION,
    INDEX `fk_messages_buyer_idx` (`buyer_id` ASC) VISIBLE,
    CONSTRAINT `fk_messages_buyer`
        FOREIGN KEY (`buyer_id`)
            REFERENCES `mydb`.`users` (`id`)
            ON DELETE CASCADE
            ON UPDATE NO ACTION)
    ENGINE = InnoDB;


INSERT INTO messages
values (1,2,3);


DROP TABLE IF EXISTS `mydb`.`message_node` ;

CREATE TABLE IF NOT EXISTS `mydb`.`message_node` (
    `id` INT NOT NULL auto_increment,
    `time` timestamp NOT NULL,
    `message` MEDIUMTEXT NOT NULL,
    `is_read` TINYINT not null,
    `sender_id` INT NOT NULL,
    `messages_list_id` INT NOT NULL,
    PRIMARY KEY (`id`),
    INDEX `fk_messages_sendeer_idx` (`sender_id` ASC) VISIBLE,
    CONSTRAINT `fk_messages_sender1`
        FOREIGN KEY (`sender_id`)
            REFERENCES `mydb`.`users` (`id`)
            ON DELETE CASCADE
            ON UPDATE NO ACTION,
    INDEX `fk_messages_messageslist_idx` (`messages_list_id` ASC) VISIBLE,
    CONSTRAINT `fk_messages_messageslist`
        FOREIGN KEY (`messages_list_id`)
            REFERENCES `mydb`.`messages` (`id`)
            ON DELETE CASCADE
            ON UPDATE NO ACTION)
    ENGINE = InnoDB;

INSERT INTO message_node
values
    (1,'2022-8-24 19:35','Hello',1,2,1),
    (2,'2022-8-24 19:40','Hello',1,3,1),
    (3,'2022-8-24 19:50','How are you?',0,2,1),
    (4,'2022-8-24 19:55','Fine thanks!',1,3,1),
    (5,'2022-8-24 19:56','How are you?',1,3,1),
    (6,'2022-8-24 19:57','I am OK',0,2,1),
    (7,'2022-8-24 19:58','Will you send me my stuff?',0,2,1),
    (8,'2022-8-24 19:59','They are on their way!!',0,3,1);






    SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
